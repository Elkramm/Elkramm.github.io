<script>
  const yesBtn = document.getElementById("yesBtn");
  const noBtn  = document.getElementById("noBtn");
  const msg    = document.getElementById("msg");
  const stage  = document.getElementById("stage");

  let tries = 0;
  const maxDodges = 7;
  let yesScale = 1;

  function show(html){
    msg.innerHTML = html;
    msg.style.display = "block";
  }

  function randomPos() {
    const s = stage.getBoundingClientRect();
    const b = noBtn.getBoundingClientRect();
    const pad = 8;

    const maxX = s.width - b.width - pad * 2;
    const maxY = s.height - b.height - pad * 2;

    const x = pad + Math.random() * Math.max(0, maxX);
    const y = pad + Math.random() * Math.max(0, maxY);
    return { x, y };
  }

  function dodge() {
    const { x, y } = randomPos();
    noBtn.style.left = x + "px";
    noBtn.style.top  = y + "px";
  }

  function growYesButton() {
    yesScale += 0.15; 
    yesBtn.style.transform = `scale(${yesScale})`;
  }

  function handleApproach() {
    if (tries < maxDodges) {
      tries++;
      dodge();
      growYesButton();

      const lines = [
        "ğŸ˜³ Oupsiâ€¦",
        "ğŸ˜‚ Presque !",
        "ğŸ™ˆ Non est timideâ€¦",
        "ğŸ˜… Attends attendsâ€¦",
        "ğŸ¥º Mais pourquoi nonâ€¦",
        "ğŸ¤­ Tu insistes hein !",
        "ğŸ˜Œ Ok okâ€¦ tu peux vraiment cliquer si tu veux."
      ];

      show(lines[Math.min(tries - 1, lines.length - 1)]);
    }
  }

  noBtn.addEventListener("mouseenter", handleApproach);
  noBtn.addEventListener("touchstart", (e) => { 
    e.preventDefault(); 
    handleApproach(); 
  }, { passive:false });

  noBtn.addEventListener("click", () => {
    if (tries < maxDodges) return;

    show(`
      <strong>Ok â¤ï¸</strong><br/>
      Merci dâ€™Ãªtre honnÃªte.<br/><br/>
      On peut quand mÃªme faire quelque chose de cool ğŸ™‚
    `);

    yesBtn.disabled = true;
    noBtn.disabled = true;
  });

  yesBtn.addEventListener("click", () => {
    show(`
      <strong>YEEES ğŸ’</strong><br/><br/>
      Que vais-je bien pouvoir tâ€™offrir ? :<br/><br/>
      ğŸŒ• La lune<br/>
      ğŸ™‚â€â†•ï¸ Moi<br/>
      ğŸ¦† Un canard en plastique nommÃ© GÃ©rard
    `);

    yesBtn.disabled = true;
    noBtn.disabled = true;
  });

  dodge();
</script>

